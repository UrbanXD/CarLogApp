bucket_definitions:
  global:
    data:
      - SELECT * FROM make
      - SELECT * FROM model
  by_user:
    parameters: SELECT request.user_id() as user_id
    data:
      - SELECT * FROM car WHERE car.owner_id = bucket.user_id
      - SELECT id, email, lastname, firstname, avatar_url, avatar_color FROM user_account WHERE user_account.id = bucket.user_id
  by_car:
    parameters:
      - SELECT id as car_id FROM car WHERE request.user_id() = owner_id
    data:
      - SELECT * FROM odometer WHERE bucket.car_id = car_id
      - SELECT * FROM fuel_tank WHERE bucket.car_id = car_id
      - SELECT * FROM expense WHERE bucket.car_id = car_id
      - SELECT * FROM odometer_log WHERE bucket.car_id = car_id
      - SELECT * FROM fuel_log WHERE bucket.car_id = car_id